import tiktoken # 字节编码
import pickle # 序列化
with open("data/shakespeare_char/meta.pkl", 'rb') as f:
    meta = pickle.load(f)
# TODO want to make this more general to arbitrary encoder/decoder schemes
stoi, itos = meta['stoi'], meta['itos']
encode = lambda s: [stoi[c] for c in s]
decode = lambda l: ''.join([itos[i] for i in l])
print(len(idx[0].tolist()))
print(decode(idx[0].tolist()))